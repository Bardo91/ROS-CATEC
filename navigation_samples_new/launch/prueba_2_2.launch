<?xml version="1.0"?>
<launch>
	<!-- Include gazebo launch file -->
	<include file="$(find uav)/launch/testbed_gazebo_4_quad.launch"/>


	<!-- Here it is configured which quadrotors are going to be used -->
	<arg name="uav_1/flying" value="1" />
	<arg name="uav_2/flying" value="1" />
	<arg name="uav_4/flying" value="1" />
	<arg name="uav_3/flying" value="1" />

	  <!-- maximum velocity and acceleration for each quadrotor -->
	  <param name="uav_1/amax" value="16" type="double" />
	  <param name="uav_1/vmax" value="2" type="double" />
	  <param name="uav_1/anglemax" value="90" type="double" />
	  <param name="uav_1/transition_time" value="15.0" type="double" />

	  <param name="uav_2/amax" value="16" type="double" />
	  <param name="uav_2/vmax" value="2" type="double" />
	  <param name="uav_2/anglemax" value="90" type="double" />
	  <param name="uav_2/transition_time" value="15.0" type="double" />

	  <param name="uav_3/amax" value="16" type="double" />
	  <param name="uav_3/vmax" value="2" type="double" />
	  <param name="uav_3/anglemax" value="90" type="double" />
	  <param name="uav_3/transition_time" value="15.0" type="double" />

	  <param name="uav_4/amax" value="16" type="double" />
	  <param name="uav_4/vmax" value="2" type="double" />
	  <param name="uav_4/anglemax" value="90" type="double" />
	  <param name="uav_4/transition_time" value="15.0" type="double" />

	<!-- The configuration parameters are given their values -->
	<param name="uav_1/flying" value="$(arg uav_1/flying)" type="bool" />
	<param name="uav_2/flying" value="$(arg uav_2/flying)" type="bool" />
	<param name="uav_3/flying" value="$(arg uav_3/flying)" type="bool" />
	<param name="uav_4/flying" value="$(arg uav_4/flying)" type="bool" />

	<!-- Nodes will start if their /uav_i/flying parameter is true  -->
	<node name="uav_1" pkg="uav" type="uav_gazebo" args="1 1" if="$(arg uav_1/flying)">
	     <remap from="uav_1/control_references_rw" to="/path_follower_1/control_references_rw" />	
	</node>
	
	<!-- Path Follower Node. -->
	<node name="simple_follower1" pkg="path_follower" type="simple_follower" args="1 1.0">
	     <remap from="/path_follower_1/way_point_callback" to="/prueba_test/out_waypoint_1" />	
	</node>


	<node name="uav_2" pkg="uav" type="uav_gazebo" args="2 1" if="$(arg uav_1/flying)">
	     <remap from="uav_2/control_references_rw" to="/path_follower_2/control_references_rw" />	
	</node>
	
	<!-- Path Follower Node. -->
	<node name="simple_follower2" pkg="path_follower" type="simple_follower" args="2 1.0">
	     <remap from="/path_follower_2/way_point_callback" to="/prueba_test/out_waypoint_2" />	
	</node>
	
	<!-- UAV 3 INTRUDER-->

	<node name="uav_3" pkg="uav" type="uav_gazebo" args="3 1" if="$(arg uav_3/flying)">
	     <remap from="uav_3/control_references_rw" to="/path_follower_3/control_references_rw" />	
	</node>
	
	<!-- Path Follower Node. -->
	<node name="simple_follower3" pkg="path_follower" type="simple_follower" args="3 1.0">
	     <remap from="/path_follower_3/way_point_callback" to="/path_planner_3/out_waypoint" />	
	</node>
	
	<!-- Path Planner Node. -->
	<node name="path_planner_3" pkg="path_planner" type="local_planner" args="3">
	    <remap from="/path_planner_3/in_waypoint" to="/temporal_wpa_3/way_point_callback" />
	</node>

	<node name="temporal_wpa_3" pkg="temporal_wpa" type="temporal_wpa" args="3" >
		<remap from="/temporal_wpa_3/ual_state" to="/uav_3/ual_state" />	
	</node> 

	<!-- UAV 4 INTRUDER-->

	<node name="uav_4" pkg="uav" type="uav_gazebo" args="4 1" if="$(arg uav_4/flying)">
	     <remap from="uav_4/control_references_rw" to="/path_follower_4/control_references_rw" />	
	</node>
	
	<!-- Path Follower Node. -->
	<node name="simple_follower4" pkg="path_follower" type="simple_follower" args="4 1.0">
	     <remap from="/path_follower_4/way_point_callback" to="/path_planner_4/out_waypoint" />	
	</node>
	
	<!-- Path Planner Node. -->
	<node name="path_planner_4" pkg="path_planner" type="local_planner" args="4">
	    <remap from="/path_planner_4/in_waypoint" to="/temporal_wpa_4/way_point_callback" />
	</node>

	<node name="temporal_wpa_4" pkg="temporal_wpa" type="temporal_wpa" args="4" >
		<remap from="/temporal_wpa_4/ual_state" to="/uav_4/ual_state" />	
	</node> 

	
	<!-- Command Dispatcher Node -->
	<!--  <node name="prueba_test" pkg="command_dispatcher" type="prueba" args="1 2" /> -->

	 <node name="command_dispatcher3" pkg="command_dispatcher" type="cmd_dispatcher_file" args="3 $(find command_dispatcher)/waypoints/way5.conf" />

	 <node name="command_dispatcher4" pkg="command_dispatcher" type="cmd_dispatcher_file" args="4 $(find command_dispatcher)/waypoints/way6.conf" />
	
<!-- 	<node name="rviz" pkg="rviz" type="rviz" args="">
	</node> -->

</launch>

